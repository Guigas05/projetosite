var CHAR_MSG_INTV=5;var CHAR_MSG_CNT=3;var CHAR_INTV_FLAG;var app=(function(app,$){var sect=new Array;function init(){setTimeout(function(){_bindOffset()},100);_bindEvents();rotateCharMsg(1);$("section.kv .kv_motion.load").removeClass("load")};function _bindOffset(){$("header > ul > li > a").each(function(e){var target=$(this).attr("href");sect.push($(target).offset().top)})}function _bindEvents(){$("header > ul > li > a").click(function(e){e.preventDefault();$('html, body').animate({scrollTop:sect[$(this).parent().index()]},500,"swing")});$(".btn_pre > a").click(function(e){e.preventDefault();$('html, body').animate({scrollTop:sect[1]},500,"swing")});$('.char_slide button[data-slide]').click(function(e){e.preventDefault();$('.char_slide button').removeClass("active");$(this).addClass("active");var slideno=$(this).data('slide');rotateCharImg(slideno)});$('.char_slide > ul').slick({slidesToShow:5,slidesToScroll:5,dots:false,focusOnSelect:false,prevArrow:'.char_prev',nextArrow:'.char_next'});var slider=$('.story_slide > ul').slick({slidesToShow:1,slidesToScroll:1,dots:false,focusOnSelect:false,prevArrow:'.story_prev',nextArrow:'.story_next'});slider.on('swipe',function(event,slick,direction){$("section.story .story_slide").find("li .img_wrap.view").removeClass("view")});slider.on('afterChange',function(event,slick,currentSlide,nextSlide){$("section.story .story_slide").find("li .img_wrap.view").removeClass("view");$("section.story .story_slide").find("li:eq("+(currentSlide+1)+") .img_wrap").addClass("view")})}function rotateCharImg(slideno){$(".char > .char_detail.view").removeClass("view");setTimeout(function(){$(".char > .char_detail:visible").css("display","none");$(".char > .char_detail.char"+slideno).css("display","block")},200);setTimeout(function(){$(".char > .char_detail.char"+slideno).addClass("view");rotateCharMsg(slideno)},300)};function rotateCharMsg(slideno){clearInterval(CHAR_INTV_FLAG);var obj=$(".char > .char_detail.char"+slideno).find("img.msg");var src=obj.attr("src");var num=src.substring(src.lastIndexOf("_")+3,src.lastIndexOf("."));CHAR_INTV_FLAG=setInterval(function(){num++;if(num>CHAR_MSG_CNT)num=1;obj.fadeOut("500",function(){src=src.substring(0,src.lastIndexOf("_")+3)+num+src.substring(src.lastIndexOf("."),src.length);$(this).attr("src",src)});obj.fadeIn("500")},1000*CHAR_MSG_INTV)};return init})(window.app||{},jQuery);$(function(){app()});function fnMove(target){var offset=$("#"+target).offset();$('html, body').animate({scrollTop:offset.top},500,"swing");return false};